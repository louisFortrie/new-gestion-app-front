import { use, useEffect, useState } from 'react'
import {
  Sheet,
  Button,
  YStack,
  XStack,
  styled,
  Text,
  AnimatePresence,
  Stack,
  TextArea,
  Dialog,
  Unspaced,
  Spinner,
} from 'tamagui'
import {
  Calendar,
  LayoutTemplate,
  MessagesSquare,
  PenSquare,
  Reply,
  Sparkles,
  Star,
  StarFull,
  Trash2,
  User2,
  X,
} from '@tamagui/lucide-icons'
import { CustomButton } from './CustomButton'
import axios from 'axios'
import useAuth from 'app/hooks/useAuth'
import useStores from 'app/hooks/useStores'

interface ReviewResponse {
  id: number
  text: string
}

interface AuthorResponses {
  author: string
  responses: ReviewResponse[]
}

export const RESTAURANT_RESPONSES: AuthorResponses[] = [
  {
    author: 'Victoria Giret-caradec',
    responses: [
      {
        id: 0,
        text: "Bonjour Victoria,\nUn grand merci pour votre superbe avis ! üåü Nous sommes ravis d'apprendre que vous avez appr√©ci√© la rapidit√© de la livraison et, surtout, que nos plats ont su vous r√©galer. Votre satisfaction est notre plus belle r√©compense !\n√Ä tr√®s bient√¥t pour une nouvelle exp√©rience tout aussi d√©licieuse. üòä",
      },
      {
        id: 1,
        text: 'Bonjour Victoria,\nQuel plaisir de lire votre message ! üòä Nous sommes ravis que vous ayez √©t√© conquise par nos plats et par la rapidit√© de notre service. Votre satisfaction nous motive √† continuer de donner le meilleur chaque jour. Merci pour vos 5 √©toiles et √† tr√®s bient√¥t ! üåü',
      },
      {
        id: 2,
        text: 'Bonjour Victoria,\nUn immense merci pour cet avis si enthousiaste ! Nous sommes heureux de savoir que notre cuisine vous a s√©duite d√®s la premi√®re bouch√©e. Cela nous fait chaud au c≈ìur de recevoir un tel retour. √Ä tr√®s vite pour une nouvelle commande gourmande ! üòã',
      },
      {
        id: 3,
        text: 'Bonjour Victoria,\nMerci infiniment pour ce retour si positif ! Savoir que notre service et nos plats vous ont pleinement satisfaite nous comble de joie. Nous esp√©rons vous r√©galer √† nouveau tr√®s bient√¥t. Passez une excellente journ√©e ! ü•∞',
      },
      {
        id: 4,
        text: "Bonjour Victoria,\nVotre avis nous fait tellement plaisir ! Nous sommes ravis que la rapidit√© de notre service et la qualit√© de nos plats aient r√©pondu √† vos attentes. Merci de partager votre exp√©rience avec autant d'enthousiasme. √Ä tr√®s bient√¥t ! üç¥‚ú®",
      },
      {
        id: 5,
        text: "Bonjour Victoria,\nQuelle joie de d√©couvrir votre avis ! Nous sommes enchant√©s de savoir que tout √©tait parfait, de la livraison √† nos plats. Merci pour ces mots chaleureux qui boostent toute l'√©quipe. √Ä bient√¥t pour d'autres d√©lices ! ü•Ç",
      },
      {
        id: 6,
        text: 'Bonjour Victoria,\nNous sommes touch√©s par vos mots et vos 5 √©toiles ! ‚ù§Ô∏è Cela nous motive encore plus √† maintenir un service rapide et une cuisine savoureuse. Un grand merci pour votre retour. Nous serions ravis de vous r√©galer √† nouveau prochainement ! ',
      },
    ],
  },
  {
    author: '‡πÄ‡∏ó‡∏û ‡∏£‡∏±‡∏ä‡∏¢‡∏≤‡∏ô‡∏ô‡∏ó',
    responses: [
      {
        id: 1,
        text: "Un grand merci pour cet avis plein d'enthousiasme ! üòä Nous sommes ravis que l'entr√©e \"Dynamite\" ait su vous s√©duire avec son go√ªt et son prix attractif. C'est un vrai plaisir de savoir que vous l'avez trouv√©e d√©licieuse. √Ä tr√®s bient√¥t pour une nouvelle d√©gustation !",
      },
      {
        id: 2,
        text: 'Merci infiniment pour ce retour si gourmand ! ü§© Nous sommes ravis que vous ayez appr√©ci√© l\'entr√©e "Dynamite" et ses saveurs. Votre satisfaction est notre priorit√©, et vos mots nous motivent √† continuer de vous r√©galer. √Ä bient√¥t !',
      },
      {
        id: 3,
        text: 'Quel plaisir de lire votre avis ! üòç Nous sommes enchant√©s que l\'entr√©e "Dynamite" ait fait votre bonheur, tant par son go√ªt que par son prix. Merci pour ces mots encourageants, et √† tr√®s vite pour une nouvelle exp√©rience tout aussi savoureuse !',
      },
      {
        id: 4,
        text: 'Merci beaucoup pour cet avis 5 √©toiles ! üåü Nous sommes ravis que l\'entr√©e "Dynamite" vous ait tant plu. Votre satisfaction nous touche √©norm√©ment, et nous esp√©rons avoir le plaisir de vous r√©galer √† nouveau prochainement.',
      },
      {
        id: 5,
        text: 'Un immense merci pour votre retour si positif ! ‚ù§Ô∏è Savoir que l\'entr√©e "Dynamite" a su r√©pondre √† vos attentes est une vraie r√©compense pour nous. Nous serions ravis de vous faire d√©couvrir d\'autres saveurs tr√®s bient√¥t.',
      },
      {
        id: 6,
        text: "Merci pour ce retour si chaleureux ! üòä Nous sommes heureux de savoir que l'entr√©e \"Dynamite\" a √©t√© un vrai r√©gal pour vous. C'est toujours un plaisir de voir nos clients satisfaits. √Ä bient√¥t pour d'autres d√©lices !",
      },
      {
        id: 7,
        text: 'Merci pour vos 5 √©toiles et ce bel avis ! ‚ú® Nous sommes ravis que vous ayez trouv√© l\'entr√©e "Dynamite" savoureuse et √©quilibr√©e. Votre retour positif est une belle r√©compense pour toute l\'√©quipe. √Ä tr√®s vite !',
      },
    ],
  },
  {
    author: 'William Leroux',
    responses: [
      {
        id: 1,
        text: 'Merci beaucoup pour votre superbe avis, William ! üòä Nous sommes ravis de savoir que vous avez trouv√© nos portions g√©n√©reuses et nos plats excellents. Au plaisir de vous accueillir √† nouveau tr√®s bient√¥t !',
      },
      {
        id: 2,
        text: 'Un grand merci, William, pour ce retour enthousiaste ! üåü Nous sommes ravis que nos portions g√©n√©reuses et notre cuisine aient su vous satisfaire. √Ä tr√®s vite pour une nouvelle exp√©rience gourmande !',
      },
      {
        id: 3,
        text: "Merci infiniment, William, pour vos 5 √©toiles ! ü§© C'est un plaisir de savoir que nos portions g√©n√©reuses ont r√©pondu √† vos attentes. Nous esp√©rons vous r√©galer √† nouveau tr√®s prochainement !",
      },
      {
        id: 4,
        text: "William, votre avis nous fait tellement plaisir ! ‚ú® Merci d'avoir pris le temps de partager votre exp√©rience. Nous sommes ravis que nos portions g√©n√©reuses et notre qualit√© aient √©t√© √† la hauteur. √Ä bient√¥t !",
      },
      {
        id: 5,
        text: 'Merci pour vos mots chaleureux, William ! ‚ù§Ô∏è Nous sommes ravis que nos portions et nos plats aient su vous conqu√©rir. Votre satisfaction est notre priorit√©. √Ä tr√®s bient√¥t !',
      },
      {
        id: 6,
        text: "Quel plaisir de lire votre avis, William ! üòä Savoir que vous avez trouv√© nos portions g√©n√©reuses et nos plats excellents est une belle r√©compense pour toute l'√©quipe. Merci encore, et √† tr√®s vite !",
      },
      {
        id: 7,
        text: 'William, un immense merci pour cet avis 5 √©toiles ! üåü Nous sommes ravis que nos portions g√©n√©reuses et notre qualit√© aient fait votre bonheur. Nous serions enchant√©s de vous revoir tr√®s bient√¥t !',
      },
    ],
  },
  {
    author: 'Ang√©lina Fernandes',
    responses: [
      {
        id: 1,
        text: 'Merci beaucoup pour cet avis fantastique, Ang√©lina ! üòä Nous sommes ravis que vous consid√©riez notre cuisine comme la meilleure du 94 et que vous vous r√©galiez √† chaque visite. Votre recommandation nous fait chaud au c≈ìur. √Ä tr√®s bient√¥t !',
      },
      {
        id: 2,
        text: 'Un immense merci, Ang√©lina, pour ces mots si √©logieux ! üåü Savoir que vous appr√©ciez autant nos plats et que vous nous consid√©rez comme un incontournable du 94 est une belle r√©compense. √Ä tr√®s vite pour continuer √† vous r√©galer !',
      },
      {
        id: 3,
        text: 'Merci infiniment pour votre superbe retour, Ang√©lina ! ‚ù§Ô∏è Cela nous touche beaucoup de savoir que notre cuisine vous r√©gale √† chaque fois. Merci pour votre confiance et votre recommandation. √Ä bient√¥t !',
      },
      {
        id: 4,
        text: "Ang√©lina, quel plaisir de lire votre avis ! ‚ú® Nous sommes ravis que vous soyez conquise √† chaque visite et que vous nous consid√©riez comme une r√©f√©rence dans le 94. Merci pour votre fid√©lit√© et √† tr√®s bient√¥t pour d'autres d√©lices !",
      },
      {
        id: 5,
        text: 'Merci beaucoup pour ce magnifique avis, Ang√©lina ! üòä Votre satisfaction et votre recommandation sont la meilleure des r√©compenses pour notre √©quipe. Nous esp√©rons vous revoir bient√¥t pour continuer √† vous faire voyager avec nos saveurs !',
      },
      {
        id: 6,
        text: 'Ang√©lina, un grand merci pour vos 5 √©toiles et vos mots si encourageants ! ü§© Nous sommes heureux de savoir que vous vous r√©galez √† chaque fois. Votre recommandation est pr√©cieuse pour nous. √Ä tr√®s bient√¥t !',
      },
      {
        id: 7,
        text: 'Merci infiniment pour votre retour, Ang√©lina ! ü•∞ Savoir que vous nous consid√©rez comme "le meilleur du 94" est un immense honneur. Nous sommes ravis de vous satisfaire √† chaque visite et serions enchant√©s de vous revoir tr√®s vite !',
      },
    ],
  },
  {
    author: 'Manga Online',
    responses: [
      {
        id: 1,
        text: 'Merci pour votre avis et cette belle note ! üòä Nous sommes ravis que vous ayez appr√©ci√© votre exp√©rience. Si vous avez des suggestions pour atteindre les 5 √©toiles, nous sommes tout ou√Øe. √Ä bient√¥t !',
      },
      {
        id: 2,
        text: "Un grand merci pour votre note ! üåü Nous sommes contents que votre exp√©rience ait √©t√© positive. Si vous voyez un point √† am√©liorer, n'h√©sitez pas √† nous le partager. √Ä tr√®s vite !",
      },
      {
        id: 3,
        text: 'Merci beaucoup pour votre retour ! üòä Votre satisfaction nous tient √† c≈ìur, et si vous avez des id√©es pour rendre votre exp√©rience encore meilleure, nous serions ravis de les entendre. √Ä bient√¥t !',
      },
      {
        id: 4,
        text: 'Merci pour ces 4 √©toiles ! ‚ú® Nous sommes heureux de savoir que vous avez appr√©ci√©. Si nous pouvons faire quoi que ce soit pour m√©riter la cinqui√®me √©toile, faites-le-nous savoir. √Ä bient√¥t !',
      },
      {
        id: 5,
        text: "Merci pour votre note ! üòä Nous sommes ravis que vous ayez pass√© un bon moment avec nous. Si vous avez des retours ou suggestions pour nous am√©liorer, n'h√©sitez pas √† nous les partager.",
      },
      {
        id: 6,
        text: 'Un grand merci pour vos 4 √©toiles ! ü§© Nous cherchons toujours √† nous d√©passer pour rendre votre exp√©rience encore meilleure. √Ä bient√¥t pour peut-√™tre d√©crocher la 5e √©toile !',
      },
      {
        id: 7,
        text: "Merci pour votre retour ! üåü Nous sommes heureux de savoir que vous √™tes satisfait. Si vous avez des id√©es pour nous aider √† atteindre l'excellence, nous sommes √† votre √©coute. √Ä bient√¥t !",
      },
    ],
  },
  {
    author: 'Obito Sid',
    responses: [
      {
        id: 1,
        text: 'Merci beaucoup pour ces 5 √©toiles ! üåü Votre satisfaction est notre plus belle r√©compense. √Ä tr√®s bient√¥t ! üòä',
      },
      {
        id: 2,
        text: 'Un immense merci pour cette belle note ! ‚ú® Nous sommes ravis de savoir que vous avez appr√©ci√© votre exp√©rience. √Ä bient√¥t !',
      },
      {
        id: 3,
        text: 'Merci infiniment pour votre note parfaite ! ü•∞ Cela nous motive √† continuer de vous offrir le meilleur. √Ä tr√®s vite !',
      },
      {
        id: 4,
        text: 'Un grand merci pour ces 5 √©toiles ! ü§© Nous sommes heureux de vous avoir pleinement satisfait. √Ä bient√¥t pour une nouvelle exp√©rience tout aussi positive !',
      },
      {
        id: 5,
        text: 'Merci pour cette note parfaite ! ‚ù§Ô∏è Votre retour compte beaucoup pour nous. Nous serons ravis de vous accueillir √† nouveau bient√¥t.',
      },
      {
        id: 6,
        text: 'Merci beaucoup pour vos 5 √©toiles ! üòä Votre satisfaction est notre priorit√©, et votre avis nous fait tr√®s plaisir. √Ä tr√®s vite !',
      },
      {
        id: 7,
        text: "Un grand merci pour cette superbe note ! üåü Nous sommes ravis d'avoir √©t√© √† la hauteur de vos attentes. √Ä tr√®s bient√¥t !",
      },
    ],
  },
  {
    author: 'Florent EYOUM',
    responses: [
      {
        id: 1,
        text: "Merci beaucoup pour votre avis, Florent ! üòä Nous sommes ravis que nos brochettes de poulet pan√© vous aient plu. Si vous avez des id√©es pour am√©liorer encore votre exp√©rience et m√©riter la 5e √©toile, n'h√©sitez pas √† nous le dire. √Ä tr√®s bient√¥t !",
      },
      {
        id: 2,
        text: 'Un grand merci, Florent, pour votre retour si positif ! üåü Nous sommes ravis de savoir que vous avez appr√©ci√© nos brochettes de poulet pan√©. Votre recommandation nous fait chaud au c≈ìur. √Ä tr√®s vite pour une nouvelle d√©gustation !',
      },
      {
        id: 3,
        text: "Merci beaucoup, Florent, pour cet avis et vos 4 √©toiles ! üòä Nous sommes ravis que nos brochettes de poulet pan√© aient √©t√© √† votre go√ªt. Si vous avez une id√©e pour nous aider √† d√©crocher la 5e √©toile, nous serions ravis de l'entendre. √Ä bient√¥t !",
      },
      {
        id: 4,
        text: "Merci pour votre retour, Florent ! ‚ú® Nous sommes heureux que vous ayez trouv√© nos plats savoureux, notamment les brochettes de poulet pan√©. Si quelque chose peut √™tre am√©lior√©, dites-le-nous, nous sommes √† l'√©coute. √Ä tr√®s bient√¥t !",
      },
      {
        id: 5,
        text: 'Un immense merci, Florent, pour vos 4 √©toiles et votre recommandation ! ‚ù§Ô∏è Nous sommes ravis de savoir que nos brochettes de poulet pan√© ont su vous s√©duire. Nous esp√©rons vous revoir bient√¥t pour continuer √† vous r√©galer !',
      },
      {
        id: 6,
        text: "Merci beaucoup, Florent, pour votre retour si encourageant ! ü§© Nous sommes ravis que nos brochettes de poulet pan√© vous aient r√©gal√©. N'h√©sitez pas √† nous faire part de vos suggestions pour rendre votre prochaine exp√©rience encore meilleure. √Ä tr√®s vite !",
      },
      {
        id: 7,
        text: 'Florent, un grand merci pour votre bel avis ! üòä Nous sommes enchant√©s que nos brochettes de poulet pan√© vous aient plu. Si vous avez des id√©es pour m√©riter la cinqui√®me √©toile, nous sommes √† votre √©coute. √Ä bient√¥t pour une nouvelle d√©gustation !',
      },
    ],
  },
  {
    author: 'Louane Mich',
    responses: [
      {
        id: 1,
        text: "Bonjour Louane,\nNous sommes d√©sol√©s d'apprendre que votre exp√©rience n'a pas √©t√© √† la hauteur de vos attentes. Chez Bangkok Factory Choisy üçç, nous veillons √† pr√©parer chaque commande avec soin et √† respecter les demandes sp√©cifiques de nos clients.\nNous allons nous pencher sur ce qui a pu se passer pour √©viter ce genre de situation √† l'avenir. Votre satisfaction est importante pour nous, et nous esp√©rons avoir l'occasion de mieux r√©pondre √† vos attentes lors d'une prochaine commande.\nBien cordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 2,
        text: "Bonjour Louane,\nNous regrettons que votre commande n'ait pas √©t√© conforme √† votre demande. Nous mettons un point d'honneur √† respecter les pr√©f√©rences de nos clients, et nous sommes sinc√®rement navr√©s pour cette erreur.\nNous allons revoir nos processus pour √©viter que cela ne se reproduise et esp√©rons que vous nous donnerez une nouvelle chance de vous satisfaire pleinement √† l'avenir.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 3,
        text: "Bonjour Louane,\nNous sommes d√©sol√©s pour ce d√©sagr√©ment. Nous faisons tout notre possible pour r√©pondre aux demandes sp√©cifiques de nos clients, et nous regrettons sinc√®rement que cela n'ait pas √©t√© respect√© pour votre riz.\nNous allons analyser ce qui a pu se passer et esp√©rons pouvoir regagner votre confiance lors d'une prochaine commande.\nAvec nos excuses,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 4,
        text: "Bonjour Louane,\nNous sommes navr√©s d'apprendre que votre riz n'a pas √©t√© pr√©par√© selon votre demande. Chez Bangkok Factory Choisy üçç, nous tenons √† respecter les besoins sp√©cifiques de nos clients, surtout lorsqu'il s'agit d'intol√©rances ou de pr√©f√©rences alimentaires.\nNous allons corriger cela pour que cela ne se reproduise pas et esp√©rons vous offrir une meilleure exp√©rience √† l'avenir.\nBien cordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 5,
        text: "Bonjour Louane,\nNous sommes d√©sol√©s que votre exp√©rience n'ait pas √©t√© satisfaisante. Nous comprenons que recevoir un plat non conforme √† vos attentes est frustrant, surtout dans votre situation.\nNous allons faire un point avec notre √©quipe pour am√©liorer notre processus et √©viter ce genre d'erreur √† l'avenir. Nous esp√©rons sinc√®rement regagner votre confiance lors d'une prochaine commande.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 6,
        text: "Bonjour Louane,\nNous sommes sinc√®rement d√©sol√©s pour cette erreur. Votre satisfaction est notre priorit√©, et nous veillons normalement √† respecter les demandes sp√©cifiques de nos clients. Nous comprenons votre frustration, et nous allons renforcer nos v√©rifications pour √©viter ce type de situation.\nNous esp√©rons avoir l'occasion de vous offrir une meilleure exp√©rience √† l'avenir.\nAvec toutes nos excuses,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 7,
        text: "Bonjour Louane,\nNous regrettons profond√©ment que votre commande n'ait pas √©t√© conforme √† votre demande. Nous nous effor√ßons de r√©pondre aux besoins sp√©cifiques de chaque client et sommes navr√©s que cela n'ait pas √©t√© respect√© pour vous.\nNous allons examiner ce qui a pu se passer et travailler √† am√©liorer nos services. Nous esp√©rons que vous nous donnerez une nouvelle chance de vous satisfaire pleinement.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
    ],
  },
  {
    author: 'F√©erhat SHN',
    responses: [
      {
        id: 1,
        text: "Bonjour F√©erhat,\nNous sommes d√©sol√©s d'apprendre que votre exp√©rience avec notre lok lak n'a pas r√©pondu √† vos attentes. Nous accordons une grande importance √† la qualit√© de nos ingr√©dients et √† la satisfaction de nos clients.\nNous allons nous pencher sur ce qui a pu poser probl√®me et veiller √† am√©liorer la qualit√© de nos plats. Nous esp√©rons avoir l'occasion de vous offrir une meilleure exp√©rience √† l'avenir.\nBien cordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 2,
        text: "Bonjour F√©erhat,\nMerci pour votre retour. Nous sommes navr√©s que vous ayez trouv√© la viande de notre lok lak trop caoutchouteuse. Chez Bangkok Factory Choisy üçç, nous veillons √† offrir des plats savoureux et de qualit√©, et nous regrettons de ne pas avoir √©t√© √† la hauteur cette fois-ci.\nNous allons examiner votre remarque avec soin et esp√©rons pouvoir vous satisfaire pleinement lors d'une prochaine visite.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 3,
        text: "Bonjour F√©erhat,\nNous sommes navr√©s de lire que vous n'avez pas √©t√© satisfait par notre lok lak. La qualit√© de nos plats est une priorit√© pour nous, et nous allons investiguer sur ce point pour √©viter que cela ne se reproduise.\nNous esp√©rons sinc√®rement regagner votre confiance lors d'une prochaine commande.\nAvec nos excuses,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 4,
        text: "Bonjour F√©erhat,\nMerci pour votre retour. Nous regrettons que votre exp√©rience n'ait pas √©t√© √† la hauteur de vos attentes, notamment concernant la texture de la viande. Votre remarque est pr√©cieuse et nous allons y porter une attention particuli√®re.\nNous esp√©rons avoir l'occasion de vous offrir une meilleure exp√©rience √† l'avenir.\nBien cordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 5,
        text: "Bonjour F√©erhat,\nNous sommes sinc√®rement d√©sol√©s que notre lok lak n'ait pas r√©pondu √† vos attentes. Nous nous engageons √† offrir des plats de qualit√©, et il semble que nous ayons manqu√© √† cet engagement cette fois-ci.\nNous allons travailler pour am√©liorer la pr√©paration de ce plat et esp√©rons pouvoir vous surprendre positivement lors d'une prochaine visite.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 6,
        text: "Bonjour F√©erhat,\nNous sommes d√©sol√©s d'apprendre que la texture de la viande de votre lok lak n'√©tait pas satisfaisante. Nous prenons vos remarques tr√®s au s√©rieux et allons imm√©diatement revoir ce point avec notre √©quipe.\nNous esp√©rons sinc√®rement que vous nous donnerez une autre chance de vous convaincre de la qualit√© de notre cuisine.\nAvec nos excuses,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
      {
        id: 7,
        text: "Bonjour F√©erhat,\nNous regrettons que votre exp√©rience n'ait pas √©t√© satisfaisante, notamment concernant la texture de la viande dans notre lok lak. Nous travaillons chaque jour pour offrir des plats de qualit√©, et nous allons corriger cela.\nNous esp√©rons pouvoir vous offrir une meilleure exp√©rience lors d'une prochaine commande.\nCordialement,\nL'√©quipe Bangkok Factory Choisy üçç",
      },
    ],
  },
]

const HorizontalSheetStyled = styled(YStack, {
  position: 'fixed',
  top: 0,
  right: 0,
  height: '100%',
  backgroundColor: '$background',
  borderLeftWidth: 1,
  borderColor: '$borderColor',
  shadowColor: '$shadowColor',
  shadowOffset: { width: -2, height: 0 },
  shadowOpacity: 0.2,
  shadowRadius: 10,
  variants: {
    position: {
      right: {
        right: 0,
      },
      left: {
        left: 0,
      },
    },
  } as const,
})

const Overlay = styled(YStack, {
  position: 'fixed',
  top: 0,
  left: 0,
  right: 0,
  bottom: 0,
  backgroundColor: 'rgba(0, 0, 0, 0.5)',
})

const LogoContainer = styled(Stack, {
  borderRadius: '$4',
  backgroundColor: '#F1F5F9',
  padding: '$3',
})

const SectionTitle = styled(Text, {
  color: '#1E293B',
  fontSize: 20,
  fontWeight: 600,
})

const TemplateCard = styled(YStack, {
  gap: '$2',
  backgroundColor: 'white',
  padding: '$4',
  borderRadius: '$4',
  height: 230,
  justifyContent: 'space-between',
  borderColor: '#E2E8F0',
  borderWidth: 1,
})

const TemplateCategory = styled(Text, {
  paddingVertical: '$2',
  paddingHorizontal: '$3',
  borderRadius: 1000,
  borderWidth: 1,
  width: 'fit-content',
  fontSize: 14,
  variants: {
    positive: {
      true: {
        borderColor: '#17B26A',
        color: '#067647',
        backgroundColor: '#DCFAE6',
      },
    },
    neutral: {
      true: {
        borderColor: '#B54708',
        color: '#B54708',
        backgroundColor: '#FEF0C7',
      },
    },
    negative: {
      true: {
        borderColor: '#B42318',
        color: '#B42318',
        backgroundColor: '#FEE4E2',
      },
    },
  } as const,
})

const TemplateTitle = styled(Text, {
  fontSize: 18,
  fontWeight: 600,
})

const TemplateDescription = styled(Text, {
  fontSize: 14,
  color: '#475569',
})
const apiUrl = process.env.NEXT_PUBLIC_API_URL

export const HorizontalSheet = ({ open, selectedReview, handleOpenPressed, handleSendPress }) => {
  const [response, setResponse] = useState(selectedReview?.reviewReply?.comment || '')
  const [templates, setTemplates] = useState<any[]>([])

  const { user } = useAuth()
  const { selectedStore } = useStores()
  console.log(selectedReview)
  const getTemplates = () => {
    axios
      .get(`${apiUrl}/api/templates/${user.id}`, {
        withCredentials: true,
      })
      .then((response) => {
        const templates = response.data.responseTemplates
        setTemplates(templates)
      })
  }

  const handleUseTemplate = (templateId) => {
    const usedTemplate = templates.find((template) => template.id === templateId)

    setResponse(usedTemplate?.message || '')
  }
  const convertStarRatingToNumber = (starRating: string) => {
    switch (starRating) {
      case 'ONE':
        return 1
      case 'TWO':
        return 2
      case 'THREE':
        return 3
      case 'FOUR':
        return 4
      case 'FIVE':
        return 5
      default:
        return 0
    }
  }

  const [loading, setLoading] = useState(false)
  const handleGenerateResponse = async () => {
    if (!selectedReview || !selectedStore) return
    setLoading(true)
    const response = await axios.post(
      `${apiUrl}/api/openAi/reply`,
      {
        review: selectedReview,
        businessName: selectedStore.title,
        reviewerName: selectedReview.reviewer.displayName,
      },
      {
        withCredentials: true,
      }
    )
    setResponse(response.data.message)
    setLoading(false)
    console.log(response)
  }

  useEffect(() => {
    if (!user) return
    getTemplates()
  }, [user])

  useEffect(() => {
    setResponse(selectedReview?.reviewReply?.comment || '')
  }, [selectedReview])

  return (
    <YStack padding="$4">
      <AnimatePresence>
        {open && (
          <>
            <Overlay
              animation="quick"
              enterStyle={{ opacity: 0 }}
              exitStyle={{ opacity: 0 }}
              opacity={1}
              onPress={() => handleOpenPressed(false)}
            />

            <HorizontalSheetStyled
              width={'70%'}
              animation="100ms"
              enterStyle={{ x: '100%' }}
              exitStyle={{ x: '100%' }}
              x={0}
            >
              <YStack padding="$4" gap={32}>
                <XStack alignItems="center" gap="$4">
                  <LogoContainer>
                    <User2 />
                  </LogoContainer>
                  <YStack>
                    <SectionTitle>Reviewer</SectionTitle>
                    <Text>{selectedReview.reviewer.displayName}</Text>
                  </YStack>
                </XStack>
                <XStack alignItems="center" gap="$4">
                  <LogoContainer>
                    <Star />
                  </LogoContainer>
                  <YStack>
                    <SectionTitle>Note</SectionTitle>
                    <XStack gap={8}>
                      <StarFull color={'orange'} size={'$1'} />
                      <Text color={'orange'}>
                        {convertStarRatingToNumber(selectedReview.starRating)}
                      </Text>
                    </XStack>
                  </YStack>
                </XStack>
                <XStack alignItems="center" gap="$4">
                  <LogoContainer>
                    <MessagesSquare />
                  </LogoContainer>
                  <YStack width={'96%'}>
                    <SectionTitle>Commentaire</SectionTitle>

                    <Text>{selectedReview.comment}</Text>
                  </YStack>
                </XStack>
                <XStack alignItems="center" gap="$4">
                  <LogoContainer>
                    <Calendar />
                  </LogoContainer>
                  <YStack>
                    <SectionTitle>Date</SectionTitle>
                    <Text>{new Date(selectedReview.createTime).toLocaleDateString('fr')}</Text>
                  </YStack>
                </XStack>
                <XStack alignItems="flex-start" gap="$4">
                  <LogoContainer>
                    <Reply />
                  </LogoContainer>
                  <YStack f={1} gap={8}>
                    <XStack justifyContent="space-between">
                      <SectionTitle>R√©ponse</SectionTitle>
                      <XStack gap={8}>
                        <Button
                          icon={loading && <Spinner />}
                          iconAfter={<Sparkles />}
                          onPress={() => handleGenerateResponse()}
                        >
                          G√©n√©rer par l'IA
                        </Button>
                        <Dialog modal>
                          <Dialog.Trigger asChild>
                            <Button iconAfter={<LayoutTemplate />}>Utiliser un template</Button>
                          </Dialog.Trigger>
                          <Dialog.Portal>
                            <Dialog.Overlay
                              key="overlay"
                              animation="quick"
                              opacity={0.5}
                              enterStyle={{ opacity: 0 }}
                              exitStyle={{ opacity: 0 }}
                            />
                            <Dialog.Content
                              width={'60%'}
                              bordered
                              elevate
                              key="content"
                              animateOnly={['transform', 'opacity']}
                              animation={[
                                'quicker',
                                {
                                  opacity: {
                                    overshootClamping: true,
                                  },
                                },
                              ]}
                              enterStyle={{ x: 0, y: -20, opacity: 0, scale: 0.9 }}
                              exitStyle={{ x: 0, y: 10, opacity: 0, scale: 0.95 }}
                            >
                              <Dialog.Title marginBottom={16}>Choisissez un template</Dialog.Title>
                              <XStack f={1} gap={16}>
                                <YStack f={1} gap={16} width={'calc(33% - 16px)'}>
                                  {templates.length > 0 &&
                                    templates
                                      .filter((template) => template.category === 'positive')
                                      .map((template) => (
                                        <TemplateCard key={template.title}>
                                          <TemplateCategory positive>Positif</TemplateCategory>
                                          <TemplateTitle>{template.title}</TemplateTitle>
                                          <TemplateDescription>
                                            {template.message}
                                          </TemplateDescription>
                                          <XStack gap={16} width={'100%'}>
                                            <Dialog.Close>
                                              <CustomButton
                                                f={1}
                                                onPress={() => handleUseTemplate(template.id)}
                                              >
                                                Utiliser
                                              </CustomButton>
                                            </Dialog.Close>
                                          </XStack>
                                        </TemplateCard>
                                      ))}
                                  {/* <TemplateCard>

            <TemplateCategory positive>Positive</TemplateCategory>
            <TemplateTitle>Merci pour vos mots doux ! </TemplateTitle>
            <TemplateDescription>
              We‚Äôre thrilled to know you enjoyed dining with us! Your satisfaction is our priority,
              and we can‚Äôt wait to serve you again soon.
            </TemplateDescription>
            <XStack gap={16}>
              <Button icon={<PenSquare />}>Modifier</Button>
              <Button icon={<Trash2 />}>Supprimer</Button>
            </XStack>
          </TemplateCard>
          <TemplateCard>
            <TemplateCategory positive>Positive</TemplateCategory>
            <TemplateTitle>Merci pour vos mots doux ! </TemplateTitle>
            <TemplateDescription>
              We‚Äôre thrilled to know you enjoyed dining with us! Your satisfaction is our priority,
              and we can‚Äôt wait to serve you again soon.
            </TemplateDescription>
            <XStack gap={16}>
              <Button icon={<PenSquare />}>Modifier</Button>
              <Button icon={<Trash2 />}>Supprimer</Button>
            </XStack>
          </TemplateCard> */}
                                </YStack>
                                <YStack f={1} gap={16} width={'calc(33% - 16px)'}>
                                  {templates.length > 0 &&
                                    templates
                                      .filter((template) => template.category === 'neutral')
                                      .map((template) => (
                                        <TemplateCard key={template.title}>
                                          <TemplateCategory neutral>Neutre</TemplateCategory>
                                          <TemplateTitle>{template.title}</TemplateTitle>
                                          <TemplateDescription>
                                            {template.message}
                                          </TemplateDescription>
                                          <XStack gap={16} width={'100%'}>
                                            <Dialog.Close>
                                              <CustomButton
                                                f={1}
                                                onPress={() => handleUseTemplate(template.id)}
                                              >
                                                Utiliser
                                              </CustomButton>
                                            </Dialog.Close>
                                          </XStack>
                                        </TemplateCard>
                                      ))}

                                  {/* <TemplateCard>
            <TemplateCategory positive>Positive</TemplateCategory>
            <TemplateTitle>Merci pour vos mots doux ! </TemplateTitle>
            <TemplateDescription>
              We‚Äôre thrilled to know you enjoyed dining with us! Your satisfaction is our priority,
              and we can‚Äôt wait to serve you again soon.
            </TemplateDescription>
            <XStack gap={16}>
              <Button icon={<PenSquare />}>Modifier</Button>
              <Button icon={<Trash2 />}>Supprimer</Button>
            </XStack>
          </TemplateCard> */}
                                </YStack>
                                <YStack f={1} gap={16} width={'calc(33% - 16px)'}>
                                  {templates.length > 0 &&
                                    templates
                                      .filter((template) => template.category === 'negative')
                                      .map((template) => (
                                        <TemplateCard key={template.title}>
                                          <TemplateCategory negative>N√©gatif</TemplateCategory>
                                          <TemplateTitle>{template.title}</TemplateTitle>
                                          <TemplateDescription>
                                            {template.message}
                                          </TemplateDescription>
                                          <XStack gap={16} width={'100%'}>
                                            <Dialog.Close>
                                              <CustomButton
                                                f={1}
                                                onPress={() => handleUseTemplate(template.id)}
                                              >
                                                Utiliser
                                              </CustomButton>
                                            </Dialog.Close>
                                          </XStack>
                                        </TemplateCard>
                                      ))}
                                  {/* <TemplateCard>
            <TemplateCategory positive>Positive</TemplateCategory>
            <TemplateTitle>Merci pour vos mots doux ! </TemplateTitle>
            <TemplateDescription>
              We‚Äôre thrilled to know you enjoyed dining with us! Your satisfaction is our priority,
              and we can‚Äôt wait to serve you again soon.
            </TemplateDescription>
            <XStack gap={16}>
              <Button icon={<PenSquare />}>Modifier</Button>
              <Button icon={<Trash2 />}>Supprimer</Button>
            </XStack>
          </TemplateCard>
          <TemplateCard>
            <TemplateCategory positive>Positive</TemplateCategory>
            <TemplateTitle>Merci pour vos mots doux ! </TemplateTitle>
            <TemplateDescription>
              We‚Äôre thrilled to know you enjoyed dining with us! Your satisfaction is our priority,
              and we can‚Äôt wait to serve you again soon.
            </TemplateDescription>
            <XStack gap={16}>
              <Button icon={<PenSquare />}>Modifier</Button>
              <Button icon={<Trash2 />}>Supprimer</Button>
            </XStack>
          </TemplateCard> */}
                                </YStack>
                              </XStack>
                              <Unspaced>
                                <Dialog.Close asChild>
                                  <Button
                                    position="absolute"
                                    top="$3"
                                    right="$3"
                                    size="$2"
                                    circular
                                    icon={X}
                                  />
                                </Dialog.Close>
                              </Unspaced>
                            </Dialog.Content>
                          </Dialog.Portal>
                        </Dialog>
                      </XStack>
                    </XStack>
                    <TextArea
                      onChangeText={(text) => setResponse(text)}
                      value={response}
                    ></TextArea>
                  </YStack>
                </XStack>
              </YStack>
              <XStack alignSelf="flex-end" padding={'$4'}>
                <CustomButton
                  onPress={() => {
                    handleSendPress(selectedReview.reviewId, response)
                    handleOpenPressed(false)
                  }}
                  alignSelf="flex-end"
                  marginRight="$4"
                >
                  Envoyer
                </CustomButton>
                <Button
                  onPress={() => handleOpenPressed(false)}
                  alignSelf="flex-end"
                  variant="outlined"
                >
                  Annuler
                </Button>
              </XStack>
            </HorizontalSheetStyled>
          </>
        )}
      </AnimatePresence>
    </YStack>
  )
}
